<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Before we start </title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-1db3f541d99483cdc7a0d9cf38862b2c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en"
  });
});
</script> 
  

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../cv.html"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-computation" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Computation</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-computation">    
        <li>
    <a class="dropdown-item" href="../computation/FourierAnalysis.html">
 <span class="dropdown-text">Fourier Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../computation/DiscreteFourierTransform_DFT.html">
 <span class="dropdown-text">Discrete Fourier Transform</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../computation/MandelbrotAndChaos.html">
 <span class="dropdown-text">Mandelbrot and Chaos</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <span class="nav-link">
<span class="menu-text">Physics</span>
    </span>
  </li>  
  <li class="nav-item">
    <span class="nav-link">
<span class="menu-text">Philosophy</span>
    </span>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#section-1-brief-mathematical-overview-of-discrete-fourier-transformdft" id="toc-section-1-brief-mathematical-overview-of-discrete-fourier-transformdft" class="nav-link active" data-scroll-target="#section-1-brief-mathematical-overview-of-discrete-fourier-transformdft">Section 1: <font color="magenta">Brief mathematical overview of discrete fourier transform(DFT)</font></a></li>
  <li><a href="#section-2-demonstration-of-dft-algorithm-based-on-above-theory" id="toc-section-2-demonstration-of-dft-algorithm-based-on-above-theory" class="nav-link" data-scroll-target="#section-2-demonstration-of-dft-algorithm-based-on-above-theory">Section 2: <font color="magenta">Demonstration of DFT Algorithm based on above theory</font></a></li>
  <li><a href="#section-3-decomposing-original-functionsignal-into-its-constituents-components" id="toc-section-3-decomposing-original-functionsignal-into-its-constituents-components" class="nav-link" data-scroll-target="#section-3-decomposing-original-functionsignal-into-its-constituents-components">Section 3: <font color="magenta"> Decomposing original function/signal into its constituents components</font></a></li>
  <li><a href="#section-4-lets-play-with-one-more-example-using-larger-sampling-size" id="toc-section-4-lets-play-with-one-more-example-using-larger-sampling-size" class="nav-link" data-scroll-target="#section-4-lets-play-with-one-more-example-using-larger-sampling-size">Section 4: <font color="magenta">Let’s play with one more example using larger sampling size</font></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><font color="blue">Before we start </font></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Fast fourier transform(FFT) is hailed as a one of the most important algorithm of the twenty first century as it lies at the heart of the most of the signal processing tasks performed in electronics. Discrete fourier tansform is a precursor of FFT but less efficient. Even for DFTs, there are many efficient version of algorithm online and inbuilt in many softwares(eg, scipy, matlab, mathematica, etc). Here we just try to dig into the fundamental mathematical result upon which DFT algorithm is based upon and show how it works at a very basic level. There are conditions when DFT algorithm fails but we won’t be discussing them here. This tutorial is focused only on mathematical overview and how the algorithm is built based upon this mathematical framework, including examples which will demonstrate how DFT algorithm works practically. For readers interested to explore further, there are tons of resources online and many signal processing books also explain them in good details.</p>
<section id="section-1-brief-mathematical-overview-of-discrete-fourier-transformdft" class="level3">
<h3 class="anchored" data-anchor-id="section-1-brief-mathematical-overview-of-discrete-fourier-transformdft">Section 1: <font color="magenta">Brief mathematical overview of discrete fourier transform(DFT)</font></h3>
<p>Discrete fourier transform is a discretized form of Fourier transform which itself originates from Fourier series analysis. In fourier series analysis any discontinuous function satisfying Dirichlet’s conditions can be approximated by complex fourier series as:</p>
<p><span class="math display">\[ \Large f(t) = \sum_{n=-\infty}^{\infty} C_{n}  exp(i \omega_{n}t) \tag{1} \]</span></p>
<p>where Fourier coefficient <span class="math inline">\(C_{n}\)</span> and frequency <span class="math inline">\(\omega_{N}\)</span> are given by:</p>
<p><span class="math display">\[\Large C_{n} = \frac{1}{T} \int_{-\frac{T}{2}}^{\frac{T}{2}} f(u) exp\left(-i \omega_{n} u\right) du\]</span> <span class="math display">\[\Large \omega_{n} = \frac{2\pi n}{T} \]</span></p>
<p>For a scenario where <span class="math inline">\(T\rightarrow \infty\)</span>, frequency spectrum <span class="math inline">\(\omega_{n}\)</span> becomes continuous and substituting fourier coefficient in above fourier series we get fourier integral</p>
<p><span class="math display">\[\Large F(\omega) = C \int_{-\infty}^{\infty} f(t) exp\left(-i \omega_{n} t\right) dt  \tag{2}\]</span></p>
<p>where coefficient C will depend on the timeperiod chosen. This integral represents <font color="red">Fourier transfrom</font> of a function <span class="math inline">\(f(t)\)</span>. This is where all the signal processing journey begins from. We have some timeseries function <span class="math inline">\(f(t)\)</span> and want to analyze its phase and frequency then we use Fourier transfrom. As you can see, this integral takes function of time - f(t) and gives function in frequency <span class="math inline">\(F(\omega)\)</span>. <font color="red">So, it helps us to extract frequency domain information by giving time domain input.</font></p>
<p><strong>Time signal as input <span class="math inline">\(\Rightarrow\)</span> Fourier Transform <span class="math inline">\(\Rightarrow\)</span> Phase &amp; frequency information as output of given signal</strong></p>
<p>This power of fourier transform to feed time signal as input, which most of the signal in electronics world are, and get information about its phase and frequency makes it the single most important algorithm of the modern world.</p>
<p><font color="blue">Where the heck does DFT come from ?</font></p>
<p>Fourirer transfrom equation is for a case where the function is continuous and extends for huge amount of time(almost infinite). However, if we have a function(e.g.&nbsp;electrical signals) that appears for a very small amount of time and can be sampled for ‘N’ number of times we can use a discrete form of the above fourier integral and this discretized version of fourier transfrom for function measured at small time interval is what DFT is. So, for a function/signal measured at certain interval of time(say T) and recorded N number of times we could write above fourier integral as:</p>
<p><span class="math display">\[\Large F(\omega) = f(0) e^{-i \omega 0} + f(1) e^{-i \omega 1T} + f(2) e^{-i \omega 2T} + .......+ f(N-1) e^{-i \omega (N-1)T} \]</span> <span class="math display">\[\Large F(\omega) = \sum_{k=0}^{N-1} f(k)e^{-i \omega kT} \tag{3}\]</span></p>
<p>You can understand this as we are measuring some electronic signal such as cell phone signal at time stamp of t = 0, t = 1,…. t= N-1 secs at discrete timeperiods 0T, 1T, 2T,…..,(N-1)T.</p>
<p>If the function(signal) we are measuring is periodic and comes at different frequencies we are measuring the function at different frequencies. For a signal with timeperiod T and measured N number of times the highest frequency with which we are measuring the function(signal) is <span class="math inline">\(\frac{1}{NT}\)</span>. Remember <span class="math inline">\(freq = \frac{1}{time}\)</span>. This is also called the fundamental frequency. So, we will have various frequency of measurements if the same signal is coming at different frequencies. <span class="math display">\[\Large \omega_{n} = 0,   \left(\frac{2\pi}{NT}\right)1,   \left(\frac{2\pi}{NT}\right)2,    \left(\frac{2\pi}{NT}\right)3,.........,\left(\frac{2\pi}{NT}\right)(N-1) \;\;\;\;\;\;\; where\;\; n = 0, 1, ....., (N-1)\]</span></p>
<p>Here <span class="math inline">\(\large \omega\)</span> represents angular frequency given by general expression <span class="math inline">\(\large \omega = \frac{2\pi}{T}\)</span></p>
<p>Using this in equation 3 and substituting ‘<span class="math inline">\(\large \omega_{n}\)</span>’ we get a general expression for discrete fourier transfrom given by:</p>
<p><span class="math display">\[\Large F(n) = \sum_{k=0}^{N-1}  f(k)e^{\huge(\frac{-i 2\pi n kT}{NT}\huge)} \;\;\;\;\;\;\; where\;\; n = 0, 1, 2,.....N-1 \]</span> (Cancelling T from numerator and denominator)</p>
<p>This expression can be written in <font color="red">more popular form of DFT expression</font> below</p>
<p><span class="math display">\[\Large F(n) = \sum_{k=0}^{N-1} f(k)e^{\huge(\frac{-i 2\pi nk}{N}\huge)} ; \;\;\;\;\;\;\;\;\; n = 0, 1, 2,.....N-1\tag{4} \]</span></p>
<p>Let us use <span class="math inline">\(e^{\huge( \frac{-i 2 \pi}{N}\huge)} = W\)</span>, for convenience. Above expression simplifies to the form</p>
<p><span class="math display">\[\Large F(n) =  \sum_{k=0}^{N-1}   \Large[f(k){W^{n}}\Large]^{k}   \tag{5}\]</span></p>
<p>For n = 0, <span class="math inline">\(W^{0} = 1\)</span> and above series expansion becomes</p>
<p><span class="math display">\[\Large F(0) = \sum_{k=0}^{N-1} f(k) =  f(0) + f(1) + f(2) + f(3) +  .....+ f(N-1)\]</span></p>
<p>For n = 1, <span class="math inline">\(W^{n} = W\)</span>,</p>
<p><span class="math display">\[\Large F(1) = \sum_{k=0}^{N-1} f(k)W^{k} =  f(0) + f(1)W + f(2)W^{2} + f(3)W^{4}.....+ f(N-1)W^{N-1}\]</span></p>
<p>For n = 2, <span class="math inline">\(W^{n} = W^{2}\)</span>,</p>
<p><span class="math display">\[\Large F(2) = \sum_{k=0}^{N-1} f(k)\Big(W^{2}\Big)^{k} =  f(0) + f(1)W^{2} + f(2)W^{4} + f(3)W^{6}.....+ f(N-1)W^{2N-2}\]</span> . . . .</p>
<p>Continuing, for n = N-1, i.e.&nbsp;<span class="math inline">\(W^{n} = W^{N-1}\)</span></p>
<p><span class="math display">\[\Large F(N - 1) = \sum_{k=0}^{N-1} f(k)\Big(W^{N-1}\Big)^{k} =  f(0) + f(1)W^{N-1} + f(2)W^{2N-2} + f(3)W^{3N - 3}.....+ f(N-1)\Big(W^{N-1}\Big)^{N-1}\]</span></p>
<p>Remember, these terms F(0), F(1), F(2),……., F(N-1) will represent amplitudes when normalized by dividing by the total number of terms ‘N’. And in our signal analysis whichever amplitudes are greatest will be the dominant term giving us the dominant frequencies(<span class="math inline">\(\omega_{n}\)</span>) given by ‘n’ value. We can write above DFT series expansion in matrix form as:</p>
$$
<span class="math display">\[\begin{bmatrix} F(0)\\
F(1)\\
F(2)\\
.\\
.\\
.\\
F(N-1)
\end{bmatrix}\]</span>
<p>=</p>
<span class="math display">\[\begin{bmatrix}
1 &amp; 1  &amp; 1  &amp; 1  &amp; .......... 1\\
1 &amp; W &amp; W^{2}&amp;  w^{3} &amp; .....W^{N-1}\\
1 &amp; W^{2}&amp;  W^{4}&amp;  W^{6}&amp; .....W^{2N - 2}\\
&amp; .&amp;. &amp; .&amp; .\\
&amp; .&amp;. &amp;. &amp; .\\
&amp; .&amp;. &amp;. &amp; .\\
1 &amp; W^{N-1}&amp;  W^{2N - 2}&amp;  W^{3N - 3}&amp; .....\Big(W^{N - 1}\Big)^{N-1}\\\end{bmatrix}\]</span>
<span class="math display">\[\begin{bmatrix}
f(0)\\
f(1)\\
f(2)\\
.\\
.\\
.\\
f(N-1)
\end{bmatrix}
\tag{6}\]</span>
<p><span class="math display">\[
\]</span> F;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; W ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;f$$</p>
<p>If we observe above matrix(W) in the middle it is a symmetric matrix. Due to its symmetric nature when we analyze a signal, DFT algorithm gives symmetrical spectrum of frequencies so we can only take half of the spectrum as the other half is simply a complex conjugate values or a mirror image of the first half. This nature of symmetry allows DFT algorithm to be optimized and fast fourier transform(FFT) algorithm exploits this property to optimize the algorithm. However, we won’t discuss FFT here. Now, lets put all this math into work and see with some examples how DFT can decode any function/signal into frequencies of its constituent component signals.</p>
</section>
<section id="section-2-demonstration-of-dft-algorithm-based-on-above-theory" class="level3">
<h3 class="anchored" data-anchor-id="section-2-demonstration-of-dft-algorithm-based-on-above-theory">Section 2: <font color="magenta">Demonstration of DFT Algorithm based on above theory</font></h3>
<div id="5e0fab5f-6d3e-48b4-9d77-eddcc333961d" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sympy <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Let’s take a test function and see above mathematical theory in action. Any wave/signal can, in general, be represented by a function below.</p>
<p><span class="math display">\[ \mathbf{f(t) = A sin(\omega t) \;\;\;\;\;\;\;\;\;\;\; where \;\;         \omega = 2\pi f}\]</span></p>
<p>where ‘A’ represents amplitude, ‘<span class="math inline">\(\omega\)</span>’ represents angular frequency. ‘f’ is just frequency. The fact that we use angular frequency comes from the mathematics because it is convenient to use polar co-ordinate system to represent complex numbers and DFT series has complex term <span class="math inline">\(e^{i\omega t}\)</span> in it. Don’t get confused one can be converted to other using above relation.</p>
<p>Take a test function <span class="math display">\[ \mathbf{f(x) = 5sin(2\pi1t) + 0.5sin(2\pi 2t) + 3sin(2\pi3t)}\]</span></p>
<p>Lets us suppose we have some kind of electrical signal represented by above function which graphically looks as shown below.</p>
<div id="fa2dfe5e-b671-49c6-ab16-fe70af5e097d" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Making a graph of above function</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.arange(<span class="dv">100</span>)<span class="op">;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> np.arange(<span class="dv">100</span>)<span class="op">;</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="bu">len</span>(f)                       <span class="co"># Total number of samples/data points.</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># If we are only measuring at one single instant we would not include 'N' in equation below. But when we are measing signals we </span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># try to sample it huge number of times so that we can get as much information about the incoming signal. </span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>f_t <span class="op">=</span> <span class="dv">5</span><span class="op">*</span>np.sin(<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>N)<span class="op">*</span>t) <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span>np.sin(<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span>(<span class="dv">2</span><span class="op">/</span>N)<span class="op">*</span>t) <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>np.sin(<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span>(<span class="dv">3</span><span class="op">/</span>N)<span class="op">*</span>t)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>func_t <span class="op">=</span> Matrix(f_t)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>plt.plot(t,f_t)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'t'</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'f(t)'</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Test function $</span><span class="er">\</span><span class="st">mathbf{f(x) = 5sin(2</span><span class="er">\</span><span class="st">pi1t) + 0.5sin(2</span><span class="er">\</span><span class="st">pi2t) + 3sin(2</span><span class="er">\</span><span class="st">pi3t)}$'</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="DiscreteFourierTransform_DFT_files/figure-html/cell-3-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>For the sake of convenience and visualization I will take the same function above and do the calculation of algorithm matrices above for N = 7 points instead of N = 100(or any other numbers) points because its not convenient and easy to visualize a matrix of shape ‘100 <span class="math inline">\(\times\)</span> 100’ inside the cell of this jupyter notebook. You can consider changing value ‘7’ in ‘time_t’ and ‘freq_f’ variables below to any other numbers(eg, 50, 100, etc) and see if the algorithm can still extract the frequency and amplitude of this function/signal. Only inconvenience would be that such a huge size of matrix is difficult to fit in the cell. Or, just comment the line which displays the matrix and rest should be fine.</p>
<div id="207dfc3b-2078-4ea2-9475-34a262d2eb58" class="cell" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting same function but with less number of points or time stamps taken. The reason graph will not look smooth is beacause </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># now I have plotted it with very few number of points. But the nature can still be seen to convince us its same function.</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>time_t <span class="op">=</span> np.arange(<span class="dv">7</span>)<span class="op">;</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>freq_f <span class="op">=</span> np.arange(<span class="dv">7</span>)<span class="op">;</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="bu">len</span>(freq_f)                       <span class="co"># Total number of samples/data points.</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>function__f <span class="op">=</span> <span class="dv">5</span><span class="op">*</span>np.sin(<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>N)<span class="op">*</span>time_t) <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span>np.sin(<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span>(<span class="dv">2</span><span class="op">/</span>N)<span class="op">*</span>time_t) <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>np.sin(<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span>(<span class="dv">3</span><span class="op">/</span>N)<span class="op">*</span>time_t)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>func_t <span class="op">=</span> Matrix(function__f)          <span class="co"># Keeping the functional values in matrix form.</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>plt.plot(time_t,function__f)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'t'</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'f(t)'</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Test function $</span><span class="er">\</span><span class="st">mathbf{f(x) = 5sin(2</span><span class="er">\</span><span class="st">pi1t) + 0.5sin(2</span><span class="er">\</span><span class="st">pi2t) + 3sin(2</span><span class="er">\</span><span class="st">pi3t)}$'</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="DiscreteFourierTransform_DFT_files/figure-html/cell-4-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>In the DFT series equation(eqn 4) above we have product of ‘n’ and ‘k’ in the exponential term. ‘t_matrix’ and ‘f_matrix’ variables represent ‘k’ and ‘n’ respectively. Then we can calculate <span class="math display">\[ e^{\huge(\frac{-i 2\pi nk}{N} \huge)} \]</span></p>
<p>and thiw will give us the matrix(W) in eqn 6. It is also called DFT kernel function.</p>
<div id="68f8a89b-be59-4b2e-82d1-ac7b3aec2a1d" class="cell" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>n_times_k <span class="op">=</span> freq_f<span class="op">*</span>time_t.reshape(<span class="bu">len</span>(time_t),<span class="dv">1</span>) </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>exp_func <span class="op">=</span> np.<span class="bu">round</span>(np.exp(<span class="op">-</span><span class="ot">1j</span><span class="op">*</span><span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>N)<span class="op">*</span>n_times_k), <span class="dv">3</span>)   </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># This is in essence calculating F(0), F(1), etc, represented by the matrix on the left hand side in eqn 6, by multiplying </span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># DFT kernel array 'exp_func' and functional values array 'function__f'.</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>dft_func <span class="op">=</span> np.dot(exp_func, function__f)                  </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="ae1047ac-d680-45ac-9f0a-2f8032b6db4b" class="cell" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let us visualize our DFT kernel matrix below. Notice these are complex numbers. Notice how first row and first column are </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># just 1 as we see in the discussion of DFT algorithm above. All other numbers are in the form a + ib where a is real part</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># and b is imaginary part. </span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>DFT_kernel <span class="op">=</span> Matrix(exp_func)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st"> DFT kernel matrix times function matrix. </span><span class="ch">\n</span><span class="st"> '</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>DFT_kernel</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 DFT kernel matrix times function matrix. 
 </code></pre>
</div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="7">
<p><span class="math inline">\(\displaystyle \left[\begin{matrix}1.0 &amp; 1.0 &amp; 1.0 &amp; 1.0 &amp; 1.0 &amp; 1.0 &amp; 1.0\\1.0 &amp; 0.623 - 0.782 i &amp; -0.223 - 0.975 i &amp; -0.901 - 0.434 i &amp; -0.901 + 0.434 i &amp; -0.223 + 0.975 i &amp; 0.623 + 0.782 i\\1.0 &amp; -0.223 - 0.975 i &amp; -0.901 + 0.434 i &amp; 0.623 + 0.782 i &amp; 0.623 - 0.782 i &amp; -0.901 - 0.434 i &amp; -0.223 + 0.975 i\\1.0 &amp; -0.901 - 0.434 i &amp; 0.623 + 0.782 i &amp; -0.223 - 0.975 i &amp; -0.223 + 0.975 i &amp; 0.623 - 0.782 i &amp; -0.901 + 0.434 i\\1.0 &amp; -0.901 + 0.434 i &amp; 0.623 - 0.782 i &amp; -0.223 + 0.975 i &amp; -0.223 - 0.975 i &amp; 0.623 + 0.782 i &amp; -0.901 - 0.434 i\\1.0 &amp; -0.223 + 0.975 i &amp; -0.901 - 0.434 i &amp; 0.623 - 0.782 i &amp; 0.623 + 0.782 i &amp; -0.901 + 0.434 i &amp; -0.223 - 0.975 i\\1.0 &amp; 0.623 + 0.782 i &amp; -0.223 + 0.975 i &amp; -0.901 + 0.434 i &amp; -0.901 - 0.434 i &amp; -0.223 - 0.975 i &amp; 0.623 - 0.782 i\end{matrix}\right]\)</span></p>
</div>
</div>
<div id="eac47b34-3c40-42c1-be2e-fa4b5d5ca8d1" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Similarly, 'f' matrix of functional values  is</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st"> Matrix representing value of given function at each instant of time </span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>func_t</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Matrix representing value of given function at each instant of time 
</code></pre>
</div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="9">
<p><span class="math inline">\(\displaystyle \left[\begin{matrix}0\\5.69827258578374\\2.31220324394625\\4.70328669089925\\-4.70328669089925\\-2.31220324394625\\-5.69827258578373\end{matrix}\right]\)</span></p>
</div>
</div>
<div id="ba401233-90c6-4bf0-bb3d-e19d8472f018" class="cell" data-execution_count="12">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now multiplying these two matrices should give us another matrix 'F'. Notice how these values are complex </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># numbers as expected.</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>product_matrix <span class="op">=</span> Matrix(dft_func)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st"> Product of kernel matrix 'W' and function matrix 'f' giving us 'F' matrix. </span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>product_matrix</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Product of kernel matrix 'W' and function matrix 'f' giving us 'F' matrix. 
</code></pre>
</div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="12">
<p><span class="math inline">\(\displaystyle \left[\begin{matrix}1.77635683940025 \cdot 10^{-15}\\- 17.5033474975615 i\\1.77635683940025 \cdot 10^{-15} - 1.74869874196651 i\\-1.77635683940025 \cdot 10^{-15} - 10.5012237781819 i\\-1.77635683940025 \cdot 10^{-15} + 10.5012237781819 i\\1.77635683940025 \cdot 10^{-15} + 1.74869874196651 i\\-4.44089209850063 \cdot 10^{-16} + 17.5033474975615 i\end{matrix}\right]\)</span></p>
</div>
</div>
<p>All values we get for F(0), F(1), F(2), etc are complex numbers in the form a + ib. Amplitude is mathematically defined as:</p>
<p><span class="math display">\[ amp = \frac{\sqrt{Re(F(k))^{2} + Im(F(k))^{2} }}{N} \]</span></p>
<p>For a complex number <span class="math inline">\(z = a + ib\)</span>, <span class="math inline">\(abs()\)</span> function in python calculates:</p>
<p><span class="math display">\[ abs(z) =  \sqrt{a^{2} + b^{2}}\]</span></p>
<div id="6096dd50-7f1d-4ce7-8b1c-2f46c90c7645" class="cell" data-execution_count="13">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating amplitudes from F(0), F(1), etc. You might be wondering why we divide by N/2 instead of N. Remember the </span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># kernel matrix is symmetric. Due to the symmetric nature effective number is just N/2. Also notice that the matrix </span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># elements are identical if we divide the whole matrix into half. For instance 2nd element is identical to 7th element, 3rd to </span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 6th and so on. </span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>amp <span class="op">=</span> <span class="bu">abs</span>(dft_func)<span class="op">/</span>(N<span class="op">/</span><span class="dv">2</span>)  </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>amp_matrix <span class="op">=</span> Matrix(amp)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st"> Calculated amplitudes of the given signal for several frequencies </span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>amp_matrix</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Calculated amplitudes of the given signal for several frequencies 
</code></pre>
</div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="13">
<p><span class="math inline">\(\displaystyle \left[\begin{matrix}5.07530525542929 \cdot 10^{-16}\\5.00095642787471\\0.499628211990433\\3.00034965090911\\3.00034965090911\\0.499628211990433\\5.00095642787471\end{matrix}\right]\)</span></p>
</div>
</div>
<div id="278e1756-6980-4737-93a6-9e8edea5109c" class="cell" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Making a stem plot of amplitudes vs frequencies. </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>plt.stem(time_t, amp)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="dv">0</span>,<span class="bu">len</span>(time_t))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Frequency'</span>, fontweight <span class="op">=</span> <span class="st">'bold'</span>, fontsize <span class="op">=</span> <span class="dv">14</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Amplitude'</span>, fontweight <span class="op">=</span> <span class="st">'bold'</span>, fontsize <span class="op">=</span> <span class="dv">14</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Amplitude vs frequency plot obtained from DFT algorithm'</span>, fontsize <span class="op">=</span> <span class="dv">14</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="DiscreteFourierTransform_DFT_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>You can see finally we recovered both amplitude and frequency by using the DFT algorithm. Also, notice the spectrum is identical on both side if divided from mid-point. This is due to the symmetric nature of the DFT kernel matrix. So, in practice we can only use half of the spectrum plot and ignore other half. These amplitudes and frequencies are exactly the same as defined in the function. Input function had frequencies 1, 2 and 3 and amplitudes 5, 0.5 and 3.</p>
</section>
<section id="section-3-decomposing-original-functionsignal-into-its-constituents-components" class="level3">
<h3 class="anchored" data-anchor-id="section-3-decomposing-original-functionsignal-into-its-constituents-components">Section 3: <font color="magenta"> Decomposing original function/signal into its constituents components</font></h3>
<p>Below we can graphically see original function/signal(red) and component functions/signals(blue). The component signals are plotted using the frequency and amplitude extracted from the DFT algorithm. So, original input signal is just a superposition of three component signals with given frequencies and amplitude. This clearly shows us how we can breakdown given function/signal into its component signals.</p>
<div id="0663807c-9e68-4e75-bb0f-c8374084491a" class="cell" data-execution_count="15">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>timestamps <span class="op">=</span> np.arange(<span class="dv">100</span>)<span class="op">;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>total_N <span class="op">=</span> <span class="bu">len</span>(timestamps)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>original_signal <span class="op">=</span> <span class="dv">5</span><span class="op">*</span>np.sin(<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>total_N)<span class="op">*</span>timestamps) <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span>np.sin(<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span>(<span class="dv">2</span><span class="op">/</span>total_N)<span class="op">*</span>timestamps) <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>np.sin(<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span>(<span class="dv">3</span><span class="op">/</span>total_N)<span class="op">*</span>timestamps)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>signal_one <span class="op">=</span> <span class="dv">5</span><span class="op">*</span>np.sin(<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>total_N)<span class="op">*</span>timestamps)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>signal_two <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span>np.sin(<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span>(<span class="dv">2</span><span class="op">/</span>total_N)<span class="op">*</span>timestamps)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>signal_three <span class="op">=</span> <span class="dv">3</span><span class="op">*</span>np.sin(<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span>(<span class="dv">3</span><span class="op">/</span>total_N)<span class="op">*</span>timestamps)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">10</span>, <span class="dv">20</span>))</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">411</span>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>plt.plot(timestamps, original_signal, color <span class="op">=</span> <span class="st">'red'</span>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Amplitude'</span>, fontweight <span class="op">=</span> <span class="st">'bold'</span>, fontsize <span class="op">=</span> <span class="dv">14</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Original input signal'</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">412</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>plt.plot(timestamps, signal_one)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Amplitude'</span> , fontweight <span class="op">=</span> <span class="st">'bold'</span>, fontsize <span class="op">=</span> <span class="dv">14</span>)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'First signal component'</span>)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">413</span>)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>plt.plot(timestamps, signal_two)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Amplitude'</span>, fontweight <span class="op">=</span> <span class="st">'bold'</span>, fontsize <span class="op">=</span> <span class="dv">14</span>)</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Second signal component'</span>)</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">414</span>)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>plt.plot(timestamps, signal_three)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Frequency'</span>, fontweight <span class="op">=</span> <span class="st">'bold'</span>, fontsize <span class="op">=</span> <span class="dv">14</span>)</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Amplitude'</span>, fontweight <span class="op">=</span> <span class="st">'bold'</span>, fontsize <span class="op">=</span> <span class="dv">14</span>)</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Third Signal component'</span>)</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="DiscreteFourierTransform_DFT_files/figure-html/cell-12-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="section-4-lets-play-with-one-more-example-using-larger-sampling-size" class="level3">
<h3 class="anchored" data-anchor-id="section-4-lets-play-with-one-more-example-using-larger-sampling-size">Section 4: <font color="magenta">Let’s play with one more example using larger sampling size</font></h3>
<p>In this example we consider a function/signal represented by: <span class="math display">\[ \mathbf{ f(t) = 5sin(2\pi 1t) + sin(2\pi6t) + 0.5sin(2\pi12t)}\]</span></p>
<p>Lets us see if we can still extract frequency and amplitude of the individual signal components of this input function/signal using the DFT algorithm we used above.</p>
<div id="b9a9605c-46f2-46d9-8d4f-e4d235cec811" class="cell" data-execution_count="16">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> np.arange(<span class="dv">100</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>no_of_freq <span class="op">=</span> np.arange(<span class="dv">100</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>total_no_sample <span class="op">=</span> <span class="bu">len</span>(dt)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>input_function <span class="op">=</span> <span class="dv">5</span><span class="op">*</span>np.sin(<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>total_no_sample)<span class="op">*</span>dt) <span class="op">+</span> np.sin(<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span>(<span class="dv">6</span><span class="op">/</span>total_no_sample)<span class="op">*</span>dt) <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span>np.sin(<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span>(<span class="dv">12</span><span class="op">/</span>total_no_sample)<span class="op">*</span>dt)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">8</span>,<span class="dv">6</span>))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>plt.plot(dt,input_function, <span class="st">'r'</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'time'</span>, fontweight <span class="op">=</span> <span class="st">'bold'</span>, fontsize <span class="op">=</span> <span class="dv">14</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Amplitude'</span>, fontweight <span class="op">=</span> <span class="st">'bold'</span>, fontsize <span class="op">=</span> <span class="dv">14</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Input signal'</span>, fontweight <span class="op">=</span> <span class="st">'bold'</span>, fontsize <span class="op">=</span> <span class="dv">14</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="DiscreteFourierTransform_DFT_files/figure-html/cell-14-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="3c7739ac-cbfa-454e-a72c-2b4dc4f1f558" class="cell" data-execution_count="17">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> DFT(f_of_x):</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Function to calculate the discrete Fourier Transform of a 1D real-valued signal/function. We supply the functional values</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co">    and this will calculate the amplitudes for that functional values."""</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    signal_size <span class="op">=</span> <span class="bu">len</span>(f_of_x)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> np.arange(signal_size)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    k <span class="op">=</span> n.reshape((signal_size, <span class="dv">1</span>))</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    kernel_W <span class="op">=</span> np.exp(<span class="op">-</span><span class="ot">2j</span><span class="op">*</span>np.pi<span class="op">*</span>k<span class="op">*</span>n<span class="op">/</span>signal_size)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    F_matrix <span class="op">=</span> np.dot(kernel_W, f_of_x)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    amplitude_values <span class="op">=</span> np.<span class="bu">round</span>(<span class="bu">abs</span>(F_matrix)<span class="op">/</span>(signal_size<span class="op">/</span><span class="dv">2</span>), <span class="dv">3</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> amplitude_values</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> DFT(input_function)   <span class="co"># Amplitudes calculated by the above DFT algorithmic function.</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> dt                    <span class="co"># Same times stamples we have taken</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizing the extraction of frequency and amplitude of the given input signal.</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">12</span>, <span class="dv">10</span>))</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">211</span>)</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>plt.stem(X, Y, <span class="st">'b'</span>, markerfmt <span class="op">=</span> <span class="st">' '</span>, basefmt <span class="op">=</span> <span class="st">'-b'</span>)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Amplitude'</span>,  fontweight <span class="op">=</span> <span class="st">'bold'</span>, fontsize <span class="op">=</span> <span class="dv">14</span>)</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Fig 1: Whole frequency spectrum with their respective amplitude'</span>, fontweight <span class="op">=</span> <span class="st">'bold'</span>, fontsize <span class="op">=</span> <span class="dv">14</span>)</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">212</span>)</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>plt.stem(X, Y, <span class="st">'b'</span>, markerfmt <span class="op">=</span> <span class="st">' '</span>, basefmt <span class="op">=</span> <span class="st">'-b'</span>)</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Freq (Hz)'</span> , fontweight <span class="op">=</span> <span class="st">'bold'</span>, fontsize <span class="op">=</span> <span class="dv">14</span>)</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Amplitude'</span>, fontweight <span class="op">=</span> <span class="st">'bold'</span>, fontsize <span class="op">=</span> <span class="dv">14</span>)</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>plt.grid(axis <span class="op">=</span> <span class="st">'y'</span>, which<span class="op">=</span><span class="st">'both'</span>)</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="dv">0</span>,<span class="dv">15</span>)</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Fig 2: Zooming into small section of the above spectrum'</span>, fontweight <span class="op">=</span> <span class="st">'bold'</span>, fontsize <span class="op">=</span> <span class="dv">14</span>)</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>    </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="DiscreteFourierTransform_DFT_files/figure-html/cell-15-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="hurray-we-got-the-expected-amplitude510.5-and-frequency1612-of-the-component-signals-as-seen-in-the-second-figure-above." class="level4">
<h4 class="anchored" data-anchor-id="hurray-we-got-the-expected-amplitude510.5-and-frequency1612-of-the-component-signals-as-seen-in-the-second-figure-above."><font color="green">Hurray! We got the expected amplitude(5,1,0.5) and frequency(1,6,12) of the component signals as seen in the second figure above.</font></h4>
<p>Below we decompose input signal(red) into its component signals(blue). First plot in <font color="red">red</font> is superposition of three succeeding plots in <font color="blue">blue</font>.</p>
<div id="82865921-ffd2-4eff-a079-631dd5b1e8ac" class="cell" data-execution_count="18">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>first_component <span class="op">=</span> <span class="dv">5</span><span class="op">*</span>np.sin(<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>total_no_sample)<span class="op">*</span>dt)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>second_component <span class="op">=</span> np.sin(<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span>(<span class="dv">6</span><span class="op">/</span>total_no_sample)<span class="op">*</span>dt)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>third_component <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span>np.sin(<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span>(<span class="dv">12</span><span class="op">/</span>total_no_sample)<span class="op">*</span>dt)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">10</span>, <span class="dv">20</span>))</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">411</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>plt.plot(dt, input_function, color <span class="op">=</span> <span class="st">'red'</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Amplitude'</span>, fontweight <span class="op">=</span> <span class="st">'bold'</span>, fontsize <span class="op">=</span> <span class="dv">14</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Original input signal'</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">412</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>plt.plot(dt, first_component)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Amplitude'</span> , fontweight <span class="op">=</span> <span class="st">'bold'</span>, fontsize <span class="op">=</span> <span class="dv">14</span>)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'First signal component'</span>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">413</span>)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>plt.plot(dt, second_component)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Amplitude'</span>, fontweight <span class="op">=</span> <span class="st">'bold'</span>, fontsize <span class="op">=</span> <span class="dv">14</span>)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Second signal component'</span>)</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">414</span>)</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>plt.plot(dt, third_component)</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Frequency'</span>, fontweight <span class="op">=</span> <span class="st">'bold'</span>, fontsize <span class="op">=</span> <span class="dv">14</span>)</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Amplitude'</span>, fontweight <span class="op">=</span> <span class="st">'bold'</span>, fontsize <span class="op">=</span> <span class="dv">14</span>)</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Third Signal component'</span>)</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="DiscreteFourierTransform_DFT_files/figure-html/cell-16-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>References: Following sources were consulted during the preparation of this lesson.</p>
<ol type="1">
<li>https://www.robots.ox.ac.uk/~sjrob/Teaching/SP/l7.pdf</li>
<li>https://pythonnumericalmethods.studentorg.berkeley.edu/notebooks/Index.html</li>
<li>“Mathematical Methods for Physics and Engineering”, K. F. Riley, M. P. Hobson, S. J. Bence, University of Cambridge, 2006</li>
</ol>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/anojkhadka\.github\.io\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Thank you for visiting.</p>
<div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>